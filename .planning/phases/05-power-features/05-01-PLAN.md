---
phase: 05-power-features
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/features/users/components/UserOrdersTab.tsx
  - src/features/retailers/components/RetailerOrdersTab.tsx
  - src/features/orders/components/OrderListPage.tsx
autonomous: true

must_haves:
  truths:
    - "Order IDs in UserOrdersTab are clickable and navigate to /orders/$orderId"
    - "Retailer names in UserOrdersTab are clickable and navigate to /retailers/$retailerId"
    - "Order IDs in RetailerOrdersTab are clickable and navigate to /orders/$orderId"
    - "Customer names in RetailerOrdersTab are clickable and navigate to /users/$userId (when available)"
    - "Order rows in OrderListPage navigate to /orders/$orderId on click"
  artifacts:
    - path: "src/features/users/components/UserOrdersTab.tsx"
      provides: "Linked order IDs and retailer names in user orders tab"
    - path: "src/features/retailers/components/RetailerOrdersTab.tsx"
      provides: "Linked order IDs and customer names in retailer orders tab"
  key_links:
    - from: "UserOrdersTab"
      to: "/orders/$orderId"
      via: "Link component or navigate on order ID click"
      pattern: "to.*orders"
    - from: "UserOrdersTab"
      to: "/retailers/$retailerId"
      via: "Link on retailer name"
      pattern: "to.*retailers"
    - from: "RetailerOrdersTab"
      to: "/orders/$orderId"
      via: "Link component or navigate on order ID click"
      pattern: "to.*orders"
---

<objective>
Make all entity references on detail pages clickable links to the referenced entity's detail page (DETL-07).

Purpose: Admins can navigate between related entities without searching — click a retailer name on a user's order to go to that retailer, click an order ID to see full order details. This is the most impactful usability improvement for support workflows.

Output: Updated UserOrdersTab, RetailerOrdersTab, and OrderListPage with navigation links.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/features/users/components/UserOrdersTab.tsx
@src/features/users/types.ts
@src/features/retailers/components/RetailerOrdersTab.tsx
@src/features/orders/components/OrderDetailPage.tsx
@src/features/orders/components/OrderListPage.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add cross-entity links in UserOrdersTab</name>
  <files>src/features/users/components/UserOrdersTab.tsx</files>
  <action>
    Import `Link` from `@tanstack/react-router` (or use `useNavigate`). Modify the existing columns:

    1. **Order ID column**: Wrap the order ID text in a Link to `/orders/${row.original.id}`. Style as clickable (text-primary, hover:underline) while keeping the CopyButton alongside. The order ID should be the link, the copy button stays as-is.

    2. **Retailer column**: When `row.original.retailerId` exists, wrap the retailer name in a Link to `/retailers/${row.original.retailerId}`. Style as clickable. When retailerId is null, show as plain text.

    Use `Link` from TanStack Router (not `<a>`) to get SPA navigation. Follow the same hover:underline pattern used in OrderDetailPage's CustomerCard/RetailerCard buttons.

    Important: `BackendUserOrder` already has `retailerId: string | null` and `retailerName: string | null` fields — use these directly. No API changes needed.
  </action>
  <verify>npm run build succeeds; visually inspect that order IDs and retailer names appear as links in user detail Orders tab</verify>
  <done>Order IDs link to /orders/$orderId; retailer names link to /retailers/$retailerId when ID available; plain text when not</done>
</task>

<task type="auto">
  <name>Task 2: Add cross-entity links in RetailerOrdersTab</name>
  <files>src/features/retailers/components/RetailerOrdersTab.tsx</files>
  <action>
    Import `Link` from `@tanstack/react-router`. Modify the existing table:

    1. **Order ID column**: Wrap order ID in a Link to `/orders/${order.id}`. Same style as Task 1.

    2. **Customer column**: The current data comes from `useRetailerOrdersQuery` which returns vendor orders via the `BackendOrder` type. Check if the order data includes `customerId` or `user.id`. If available, wrap customer name in a Link to `/users/${userId}`. If not available, keep as plain text.

    Note: The retailer orders query transforms to `OrderViewModel` which has `id` but may not have `customerId`. Check the raw BackendOrder type — it has a `user` nested object with `id`. The transform may need to preserve `customerId` in the ViewModel. If OrderViewModel doesn't have customerId, add a `customerId: string | null` field to OrderViewModel and populate it from `backend.user?.id ?? backend.customerId ?? null` in `toOrderViewModel`.

    Also add row click to navigate to order detail (click anywhere on row navigates to order, except on the copy button).
  </action>
  <verify>npm run build succeeds; retailer detail Orders tab shows clickable order IDs and customer names</verify>
  <done>Order IDs link to /orders/$orderId; customer names link to /users/$userId when ID available; row click navigates to order</done>
</task>

<task type="auto">
  <name>Task 3: Add row click navigation in OrderListPage</name>
  <files>src/features/orders/components/OrderListPage.tsx</files>
  <action>
    The OrderListPage DataTable already has clickable order IDs (they navigate via the column definition). But clicking anywhere else on the row doesn't navigate. Add an `onRowClick` handler to the DataTable usage (or wrap rows with a click handler) that navigates to `/orders/${row.original.id}`.

    Check if the DataTable component supports an `onRowClick` prop. If not, add cursor-pointer styling to rows and attach onClick with `useNavigate()`. Be careful not to trigger navigation when clicking copy buttons — use event.target checks or stopPropagation on CopyButton.

    Also verify: the order ID column already links to order detail. If it does, just add the row click for the entire row. If the order ID is just copyable (not linked), make it a link too.
  </action>
  <verify>npm run build succeeds; clicking an order row in the order list navigates to order detail</verify>
  <done>Order rows are clickable and navigate to /orders/$orderId; copy buttons still work without triggering navigation</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] UserOrdersTab: order IDs and retailer names are clickable links
- [ ] RetailerOrdersTab: order IDs and customer names are clickable links
- [ ] OrderListPage: clicking a row navigates to order detail
- [ ] All links navigate to correct entity detail pages
- [ ] CopyButton clicks don't trigger navigation
- [ ] No TypeScript errors
</verification>

<success_criteria>
- All tasks completed
- All entity references across all detail pages are clickable navigation links
- No regression in existing functionality (copy buttons, status badges, pagination)
- DETL-07 requirement fully satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/05-power-features/05-01-SUMMARY.md`
</output>
