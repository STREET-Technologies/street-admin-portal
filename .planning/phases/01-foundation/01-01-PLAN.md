---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - package-lock.json
  - vite.config.ts
  - tsconfig.json
  - tsconfig.app.json
  - tsconfig.node.json
  - src/index.css
  - src/main.tsx
  - src/vite-env.d.ts
  - src/lib/utils.ts
  - components.json
  - eslint.config.js
  - .env.example
  - .env.production
  - tailwind.config.ts
  - postcss.config.js
autonomous: true
must_haves:
  truths:
    - "npm run dev starts without errors on the new branch"
    - "npm run build produces zero TypeScript errors with strict mode"
    - "Tailwind v4 classes render correctly in the browser"
    - "TanStack Router plugin generates routeTree.gen.ts"
    - "Path alias @/* resolves correctly"
  artifacts:
    - path: "vite.config.ts"
      provides: "Vite 6 config with React SWC, TanStack Router plugin, Tailwind v4 plugin, path alias"
      contains: "@tanstack/router-plugin"
    - path: "tsconfig.app.json"
      provides: "Strict TypeScript configuration"
      contains: "\"strict\": true"
    - path: "src/index.css"
      provides: "Tailwind v4 CSS-first config with STREET theme tokens"
      contains: "@import"
    - path: "src/main.tsx"
      provides: "React 18 entry point"
      contains: "createRoot"
    - path: "src/lib/utils.ts"
      provides: "cn() utility for Tailwind class merging"
      contains: "twMerge"
    - path: "components.json"
      provides: "shadcn/ui configuration for Tailwind v4"
    - path: "package.json"
      provides: "Updated dependencies with TanStack Router, Zustand, ky, Tailwind v4"
      contains: "@tanstack/react-router"
  key_links:
    - from: "vite.config.ts"
      to: "src/routeTree.gen.ts"
      via: "TanStack Router plugin auto-generates route tree"
      pattern: "TanStackRouterVite"
    - from: "vite.config.ts"
      to: "src/index.css"
      via: "Tailwind v4 Vite plugin processes CSS"
      pattern: "tailwindcss"
---

<objective>
Create the redesign/admin-portal branch and scaffold the project with the new tech stack.

Purpose: Establish the foundation that all other Phase 1 plans build on — new branch, Tailwind v4, TanStack Router, strict TypeScript, clean directory structure.
Output: A clean, building project on a new branch with zero old application code and the full new stack configured.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/research/STACK.md
@.planning/research/ARCHITECTURE.md
@.planning/codebase/STACK.md

Existing files to reference:
@src/index.css (current Tailwind v3 theme tokens — preserve STREET brand colors)
@.env.example
@.env.production
@package.json (current deps — know what to keep/remove/upgrade)
@vite.config.ts (current config)
@tsconfig.app.json (current config — switching to strict)
@components.json (current shadcn/ui config)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create branch and clean project scaffold</name>
  <files>package.json, vite.config.ts, tsconfig.json, tsconfig.app.json, tsconfig.node.json, eslint.config.js, .env.example, .env.production, components.json</files>
  <action>
    1. Create and checkout branch `redesign/admin-portal` from main.

    2. Remove all old application source code. Delete these directories and files:
       - src/components/ (all feature components + ui/ — will re-add shadcn/ui fresh)
       - src/pages/
       - src/services/
       - src/data/
       - src/constants/
       - src/hooks/
       - src/types/
       - src/utils/
       - src/assets/
       - src/App.tsx
       - docs/ (old docs)
       Keep: src/main.tsx (will rewrite), src/index.css (will rewrite), src/lib/utils.ts (will rewrite), src/vite-env.d.ts, public/ (logos, fonts)
       Keep: .planning/, .env files, config files at root (will update them)

    3. Create the new directory structure (empty directories):
       ```
       src/
         app/
           layout/
         features/
           auth/
             components/
             context/
             hooks/
             api/
           users/
             components/
             api/
           retailers/
             components/
             api/
           couriers/
             components/
             api/
           orders/
             components/
             api/
           notes/
             components/
             api/
           referrals/
             components/
             api/
           settings/
             components/
         components/
           ui/
           shared/
         lib/
         hooks/
         types/
         constants/
       ```
       Add a .gitkeep file in each empty leaf directory so git tracks them.

    4. Update package.json:
       - Remove: react-router-dom, tailwindcss (v3), postcss, autoprefixer, tailwindcss-animate, lovable-tagger, @tailwindcss/typography, all individual @radix-ui/* packages, embla-carousel-react, input-otp, react-resizable-panels, vaul, recharts, react-day-picker
       - Add: @tanstack/react-router, zustand, ky, tailwindcss@^4.1, @tailwindcss/vite
       - Add devDeps: @tanstack/router-plugin, @tanstack/react-query-devtools
       - Keep: react, react-dom, @tanstack/react-query, react-hook-form, @hookform/resolvers, zod, class-variance-authority, clsx, tailwind-merge, lucide-react, sonner, date-fns, cmdk, next-themes
       - Update: typescript to ^5.7, vite to ^6.1, @vitejs/plugin-react-swc to ^3.5
       - Set name to "street-admin-portal"
       - Add "typecheck" script: "tsc --noEmit"

    5. Run npm install to generate new lock file.

    6. Update vite.config.ts:
       - Import tailwindcss from "@tailwindcss/vite"
       - Import TanStackRouterVite from "@tanstack/router-plugin/vite"
       - Remove lovable-tagger import
       - Plugins: react(), tailwindcss(), TanStackRouterVite({ routesDirectory: "./src/app/routes", generatedRouteTree: "./src/routeTree.gen.ts" })
       - Keep path alias and port 8081

    7. Update tsconfig.app.json — enable strict mode:
       - Set "strict": true
       - Remove "noImplicitAny": false, "noFallthroughCasesInSwitch": false
       - Set "noUnusedLocals": true, "noUnusedParameters": true
       - Keep baseUrl, paths, target, module, jsx settings

    8. Update .env.example to document all env vars:
       ```
       VITE_API_URL=http://localhost:8080/v1
       VITE_PORT=8081
       VITE_DEV_BYPASS_AUTH=false
       ```
       Keep .env.production as-is.

    9. Update eslint.config.js — remove lovable-tagger references if any, keep existing rules.

    10. Update components.json for Tailwind v4 + new structure:
        - Set cssVariables: true
        - Update aliases to match new structure (components: "@/components", ui: "@/components/ui", lib: "@/lib", hooks: "@/hooks")
  </action>
  <verify>
    Run `npm install` completes without errors.
    Run `npx tsc --noEmit` — may have errors from missing source files, that's expected at this stage.
    Confirm directory structure exists with `ls -R src/`.
  </verify>
  <done>Branch created, old code removed, new directory structure in place, package.json updated with new stack, vite.config.ts configured, TypeScript strict mode enabled.</done>
</task>

<task type="auto">
  <name>Task 2: Configure Tailwind v4, shadcn/ui, and minimal entry point</name>
  <files>src/index.css, src/main.tsx, src/lib/utils.ts, src/vite-env.d.ts</files>
  <action>
    1. Rewrite src/index.css for Tailwind v4 CSS-first configuration:
       - Replace `@tailwind base/components/utilities` with `@import "tailwindcss"`
       - Add `@import "tw-animate-css"` (install tw-animate-css first: `npm install tw-animate-css`)
       - Use `@theme` directive for custom theme tokens
       - Preserve ALL STREET brand colors from the current index.css (both light and dark mode HSL values)
       - Preserve sidebar CSS variables
       - Preserve custom font-face declarations (Hanson, Barlow)
       - Preserve the .street-logo, .street-title, .street-gradient utility classes

       Key theme mapping (CSS-first format):
       ```css
       @import "tailwindcss";
       @import "tw-animate-css";

       @custom-variant dark (&:is(.dark *));

       @theme inline {
         --color-background: hsl(var(--background));
         --color-foreground: hsl(var(--foreground));
         /* ... map all CSS vars to Tailwind theme */
         --radius-sm: calc(var(--radius) - 4px);
         --radius-md: calc(var(--radius) - 2px);
         --radius-lg: var(--radius);
         --radius-xl: calc(var(--radius) + 4px);
       }
       ```
       Then define :root and .dark CSS custom properties with the STREET HSL values.

    2. Rewrite src/lib/utils.ts:
       ```typescript
       import { type ClassValue, clsx } from "clsx";
       import { twMerge } from "tailwind-merge";

       export function cn(...inputs: ClassValue[]) {
         return twMerge(clsx(inputs));
       }
       ```

    3. Run `npx shadcn@latest init` — select defaults, ensure it uses the new Tailwind v4 setup. If it asks, select: New York style, Zinc color, CSS variables yes.
       Then add core components needed for Phase 1:
       ```
       npx shadcn@latest add button card separator sidebar breadcrumb
       npx shadcn@latest add dropdown-menu avatar badge skeleton
       npx shadcn@latest add tabs tooltip sonner command
       npx shadcn@latest add dialog input label form select switch
       ```

    4. Create minimal src/main.tsx:
       ```typescript
       import React from "react";
       import ReactDOM from "react-dom/client";
       import "./index.css";

       // Temporary placeholder — will be replaced by App component in Plan 03
       function App() {
         return (
           <div className="flex h-screen items-center justify-center">
             <h1 className="text-2xl font-bold">STREET Admin Portal</h1>
           </div>
         );
       }

       ReactDOM.createRoot(document.getElementById("root")!).render(
         <React.StrictMode>
           <App />
         </React.StrictMode>
       );
       ```

    5. Verify: run `npm run dev` — page should load showing the placeholder text with correct Tailwind styling.
    6. Verify: run `npm run build` — should complete with zero errors.
  </action>
  <verify>
    `npm run dev` starts and the page loads without console errors.
    `npm run build` completes successfully.
    shadcn/ui components exist in src/components/ui/.
    Tailwind classes render correctly (text-2xl, font-bold apply visibly).
  </verify>
  <done>Tailwind v4 configured with STREET theme, shadcn/ui initialized with core components, minimal entry point builds and runs cleanly.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run dev` starts without errors
- [ ] `npm run build` succeeds with zero TypeScript errors
- [ ] `npx tsc --noEmit` passes (strict mode)
- [ ] New directory structure exists under src/
- [ ] shadcn/ui components present in src/components/ui/
- [ ] Branch `redesign/admin-portal` exists and is checked out
- [ ] STREET brand colors preserved in index.css
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Clean building project on redesign/admin-portal branch
- Ready for parallel Plans 02 and 03
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
